<!DOCTYPE html>
<html>
  <head>
    <script src="/static/js/psiturk.js" type="text/javascript"></script>
    <script src="/static/js/jspsych/jspsych.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-html-keyboard-response.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-html-button-response.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-image-keyboard-response.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-image-button-response.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-webgazer-init-camera.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-webgazer-calibrate.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-webgazer-validate.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-survey-text.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-survey-html-form.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-preload.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-browser-check.js"></script>
    <script src="/static/js/jspsych/plugins/plugin-fullscreen.js"></script>
    <script src="/static/js/jspsych/webgazer/webgazer.js"></script>
    <script src="/static/js/jspsych/extension-webgazer.js"></script>
    <link
      rel="stylesheet"
      href="/static/css/jquery-ui-webgazer.css"
      type="text/css"
    />
    <style>
      .jspsych-content {
        max-width: 100%;
      }
    </style>
  </head>

  <body></body>
  <script>
    function onexit() {
      self.close(); // no harm, no foul here
    }
    var __dev__ = false;
    var psiTurk = new PsiTurk(uniqueId, adServerLoc, mode);

    var browser_width = 0;
    var browser_height = 0;
    
    var enter_fullscreen = {
      type: jsPsychFullscreen,
      fullscreen_mode: true,
    }

    var exit_fullscreen = {
      type: jsPsychFullscreen,
      fullscreen_mode: false,
      on_finish: function () {
        jsPsych.endExperiment(
          "Thank you for participating!\nYou should be redirected to the submit page now."
        );
      },
    }

    var experiment_id = { set_name: "mturk_ES_v05" };
    var jsPsych = initJsPsych({
      minimum_valid_rt: 3000,
      extensions: [{ type: jsPsychExtensionWebgazer }],
      on_data_update: function (data) {
        /*for (const [key, value] of Object.entries(data)) {
        psiturk.recordUnstructuredData(key, value);
      }*/
        psiTurk.recordTrialData(data);
        psiTurk.saveData({
          success: function () {
            // fuction to run if there is no issues.
          },
          error: function () {
            // function to run if there was an error
            window.location.replace("error.html");
          },
        });
      },
      on_finish: function () {
        psiTurk.saveData({
          success: function () {
            // fuction to run if there is no issues.
            psiTurk.completeHIT();
          },
          error: function () {
            // function to run if there was an error
            window.location.replace("error.html");
          },
        });
      },
    });

    var zoom_ratio = { zoom_ratio: window.devicePixelRatio };

    jsPsych.data.addProperties(experiment_id);
    jsPsych.data.addProperties(zoom_ratio);

    var blank_screen = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: "",
      choices: "NO_KEYS",
    };

    var preload = {
      type: jsPsychPreload,
      auto_preload: true,
      images: [
        "/static/images/ku_logo_dk_v.png",
        "/static/images/face_position.png",
        "/static/images/Sitting_position_smaller.png",
        "/static/images/mturk_ES_v05/meco_para_12_1280_720.png",
        "/static/images/mturk_ES_v05/meco_para_12_qa_1_1280_720.png",
        "/static/images/mturk_ES_v05/a_Kenya_1_1280_720.png",
        "/static/images/mturk_ES_v05/a_Kenya_1_qa_0_1280_720.png",
        "/static/images/mturk_ES_v05/a_Amazonrainforest_2_1280_720.png",
        "/static/images/mturk_ES_v05/a_Amazonrainforest_2_qa_1_1280_720.png",
        "/static/images/mturk_ES_v05/a_SouthernCalifornia_3_1280_720.png",
        "/static/images/mturk_ES_v05/a_SouthernCalifornia_3_qa_2_1280_720.png",
        "/static/images/mturk_ES_v05/a_Kenya_2_1280_720.png",
        "/static/images/mturk_ES_v05/a_Kenya_2_qa_3_1280_720.png",
        "/static/images/mturk_ES_v05/a_Force_4_1280_720.png",
        "/static/images/mturk_ES_v05/q_after_a_Force_4_qa_2_1280_720.png",
        "/static/images/mturk_ES_v05/a_Computationalcomplexitytheory_0_1280_720.png",
        "/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_0_qa_0_1280_720.png",
        "/static/images/mturk_ES_v05/a_Construction_0_1280_720.png",
        "/static/images/mturk_ES_v05/q_after_a_Construction_0_qa_3_1280_720.png",
        "/static/images/mturk_ES_v05/a_Computationalcomplexitytheory_1_1280_720.png",
        "/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_1_qa_4_1280_720.png",
        "/static/images/mturk_ES_v05/a_Computationalcomplexitytheory_2_1280_720.png",
        "/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_2_qa_1_1280_720.png",
      ],
    };

    var subject_specs = {
      type: jsPsychBrowserCheck,
      features: ["width", "height", "browser", "mobile", "fullscreen"],
      on_finish: function(data) {
        browser_width = data.width;
        browser_height = data.height;
      }
    };

    //#region Welcome Instructions
    var welcome = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <img src="/static/images/ku_logo_dk_v.png" alt="KU Logo" class="ku-logo"> 
        <h1>Welcome!</h1>
        <h3>Eye tracking experiment for natural language processing</h3>
        <p>The aim of this project is to enable the creation of a multilingual low-cost eye-tracking dataset, designed to make artificial intelligence-based language technologies fair and transparent.
        <p>You can read more about the project <a href="https://cst.ku.dk/english/projects/low-cost-eye-tracking-corpus-for-explainable-natural-language-processing/">here</a>.</p>
        <p>For questions about the experiment:</p>
        <ul>Ribeiro, Tiago - Research Assistant - <a href = "mailto: tiri@di.ku.dk">tiri@di.ku.dk</a></ul>
        <p>Project Leaders:</p>
        <ul>Søgaard, Anders - Professor - <a href = "mailto: soegaard@di.ku.dk">soegaard@di.ku.dk</a></ul>
        <ul>Hollenstein, Nora - Assistant Professor - <a href = "mailto: nora.hollenstein@hum.ku.dk">nora.hollenstein@hum.ku.dk</a></ul>
      </div>
      `,
      choices: ["Click to begin"],
      post_trial_gap: 50,
    };

    var experiment_done = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <img src="/static/images/ku_logo_dk_v.png" alt="KU Logo" class="ku-logo"> 
        <h1>Thank you for  participating!</h1>
        <h4>Please click the button to finish the experiment, you will be redirected to MTurk to submit your data. Thank you!</h4>
        <h2>Eye tracking experiment for natural language processing</h2>
        <p>You can read more about the project <a href="https://cst.ku.dk/english/projects/low-cost-eye-tracking-corpus-for-explainable-natural-language-processing/">here</a>.</p>
        <p>For questions & feedback about the experiment:</p>
        <ul>Ribeiro, Tiago - Research Assistant - <a href = "mailto: tiri@di.ku.dk">tiri@di.ku.dk</a></ul>
        <p>Project Leaders:</p>
        <ul>Søgaard, Anders - Professor - <a href = "mailto: soegaard@di.ku.dk">soegaard@di.ku.dk</a></ul>
        <ul>Hollenstein, Nora - Assistant Professor - <a href = "mailto: nora.hollenstein@hum.ku.dk">nora.hollenstein@hum.ku.dk</a></ul>
      </div>
      `,
      choices: ["Click to Finish"],
      on_start: function () {
        jsPsych.extensions.webgazer.pause();
        // https://dev.to/morinoko/stopping-a-webcam-with-javascript-4297
        // Stop webcam
        const video = document.querySelector("video");
        if (video !== null) {
          // A video's MediaStream object is available through its srcObject attribute
          const mediaStream = video.srcObject;

          // Through the MediaStream, you can get the MediaStreamTracks with getTracks():
          const tracks = mediaStream.getTracks();

          // Or stop all like so:
          tracks.forEach((track) => track.stop());
        }
      },
    };

    var instructions = `
      <h3>Task Instructions:</h3>
      <p>There is two tasks present in the experiment: 
      <p><b>Task 1, the normal reading task</b>

        <p>You will be presented with a paragraph you should read from beginning to end as naturally as you would read any other text. There is no time limit. After finishing and moving to the next screen, you will need to answer a comprehension question about the paragraph.

      <p><b>Task 2, the information searching task,</b> 
      
        <p>You will be presented with a question which you should read carefully. On the next screen, a paragraph will be presented which contains the answer to the question shown before. Read the text until you have found the answer. There is no time limit. On the following screen, you will then see the same question again. At this point, you will need to provide an answer based on the paragraph you read. 
      
      <p>Each of these steps is preceded by a black fixation cross in the middle of the screen, which you should focus on between steps. <b>When done reading texts, you will press <i>Spacebar</i> on your keyboard to move to the next screen.</b>
      
      <p>After two trials, we will recalibrate the eye-tracker to ensure better data quality. You may take a small pause before these re-calibrations.

      <p>You will now fill out a short questionnaire with some data needed for the experiment. 
        `;

    //<p>Before each task, you will be given an example to practice.

    var camera_instructions = `    
        <h1>Experiment Instructions</h1>
        <h4>Expected duration: 20-30 mins (including small pauses during calibration)</h4> 
        <p>This experiment uses your camera for eye tracking. In order  to participate you must allow the experiment to use your camera.
        <p>We would like to remind you that we are <b>only collecting the information about where you look on your screen, no video is recorded.</b>
        <p>Please follow the instructions below.</p>
        <h3>Camera Instructions:</h3>
        <p>1. Keep your head still and try to read by only moving your eyes when performing the different tasks.
        <p>2. Keep any light sources in front of you, so the webcam can clearly see your face. Please avoid having a window behind you.
        <p>3. Disable notifications to avoid distractions.
        <p>4. Close any unnecessary applications or tabs as the eye-tracking software is quite demanding. 
      `;

    var trial_example_instructions = {
      type: jsPsychHtmlButtonResponse,
      stimulus:
        `
      <div class="left-align" style="margin-left:15%;margin-right:15%">` +
        instructions +
        `</div>
      `,
      choices: ["Continue to Questionaire"],
      post_trial_gap: 50,
    };

    var camera_instructions = {
      type: jsPsychHtmlButtonResponse,
      stimulus:
        `
      <div class="left-align">` +
        camera_instructions +
        `<p style="text-align: center;"><b>To continue with the experiment, we will check your browser to confirm that it supports the eye-tracking software.</b>
      </div>
      `,
      choices: ["Continue to Trial Instructions"],
      post_trial_gap: 50,
    };

    var browser_resolution_low = {
      type: jsPsychHtmlButtonResponse,
      on_start: function (trial) {
        if ((browser_height > 0) && (browser_width > 0)) {
          trial.stimulus =
            `
          <div class="left-align">
            <h1>Browser resolution is too small for this experiment. 😢</h1>
            <h3>Currently the eye-tracking software for this experiment requires your screen to have at least a resolution of <b>1280x720</b>.</h3>
            <h3>The resolution we detected for your screen is: <b>` +
            browser_width +
            "x" +
            browser_height +
            `</b>. Note, your browser might report a lower resolution due to different factors which may result
            in the values being different than those specified on the screen. 
            <p>If you have a larger screen available, you can attempt to use it instead. Otherwise, thank you for your interest in this topic!</p>
          </div>
          `;
        }
      },
      stimulus: `
      <div class="left-align">
        <h1>Browser resolution is too small for this experiment. 😢</h1>
        <h3>Currently the eye-tracking software for this experiment requires your screen to have at least a resolution of <b>1280x720</b>.</h3> Note, your browser might report a lower resolution due to different factors, like scaling or zoom which might result
            in the values being different than those specified on the screen. 
        <p>If you have a larger screen available, you can attempt to use it instead. Otherwise, thank you for your interest in this topic!</p>
      </div>
      `,
      on_finish: function () {
        onexit();
      },
      choices: ["Click to leave the experiment"],
      post_trial_gap: 50,
    };

    //#region if nodes

    var if_resolution_check = {
      timeline: [browser_resolution_low, blank_screen],
      conditional_function: function () {
        browser_check_data = jsPsych.data.getLastTrialData();
        var tolerance = 20;
        var width_wtol = browser_check_data["trials"][0]["width"] + tolerance;
        var height_wtol = browser_check_data["trials"][0]["height"] + tolerance;
        if (
          (width_wtol < 1280) ||
          (height_wtol < 720)
        ){
          return true;
        }
          
        else {
          return false;
        }
      },
    };

    //#endregion

    //#region Camera Calibration

    var before_camera = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">      
        <h1>Great! We are ready to start.</h1>
        <p>On the next screen, you will be asked by the browser to allow the usage of your webcam.
        <p>We would like to remind you that <b>the video is not captured or stored, and it is only used to deduct where you are looking</b>. 
        <p>The eye-tracking software is quite demanding, so we recommend closing any other applications/tabs in the background.
        <p>The next screen will load all the necessary components for eye-tracking, this might take some time depending on your computer.
        <p><b>Please be patient 😊</b>
      </div>
      `,
      choices: ["Continue to Camera Initialization"],
      post_trial_gap: 50,
    };

    var instructions_light_screen_setup_image = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align"> 
        <h1>Setup Instructions:</h1>
        Before we start, we would like to show you our suggestions on how to setup for the experiment.
        <p>Please observe the image below where we display the preferred setup for this experiment. Try to follow this setup as best as possible.
        <center><img src="/static/images/Sitting_position_smaller.png" alt="Instructional Image"></center>
      </div>
      `,
      choices: ["Continue with instructions"],
      post_trial_gap: 50,
    };

    var init_camera = {
      type: jsPsychWebgazerInitCamera,
      instructions: `
      <div class="jspsych-content">
        <h3>Eye-Tracking Software Instructions:</h3>
        <p>Take a moment to sit comfortably and follow the instructions below:
        <center><img src="/static/images/face_position.png" alt="Instructional Image"></center>
        <p>When your face is centered in the box and the box is green, you can click to continue.
        <p><b>To complete this experiment, we will set your browser to fullscreen.</b> 
        <p><b>We will perform a resolution check to see if the Eye-Tracking software can work properly</b>. The screen resolution needs to be at least <b>1280x720</b>.
        <p style="color:red;"><b>You will need to keep this window in focus and in fullscreen for the remainder of the experiment.</b> Failing to do so, can cause your HIT to be rejected.
        <p>At the end of the experiment we will exit fullscreen mode.
      </div>
          `,
    };

    var calibration_instructions = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <p>Great! Now the eye tracker will be calibrated to translate the image of your eyes from the webcam to a location on your screen.</p>
        <p>To do this, you need to click a series of dots.</p>
        <p>Keep your head still, look at the dot and click on each one while fixating them.</p>
      </div>
      `,
      choices: ["Click to begin"],
      post_trial_gap: 500,
    };

    var calibration = {
      type: jsPsychWebgazerCalibrate,
      calibration_points: [
        [60, 60],
        [50, 50],
        [25, 25],
        [25, 75],
        [75, 25],
        [75, 75],
        [40, 40],
        [40, 60],
        [60, 40],
      ],
      //calibration_points: [[10,10],[10,30],[10,50],[10,70],[10,90],[30,10],
      //[30,30],[30,50],[30,70],[30,90],[50,10],[50,30],
      //[50,50],[50,70],[50,90],[70,10],[70,30],[70,50],
      //[70,70],[70,90],[90,10],[90,30],[90,50],[90,70],
      //[90,90]],
      // calibration_points: [
      //   [10,10],[10,50],[10,90],
      //   [30,10],[30,50],[30,90],
      //   [40,10],[40,30],[40,40],[40,45],[40,50],[40,55],[40,60],[40,70],[40,90],
      //   [50,10],[50,30],[50,40],[50,45],[50,50],[50,55],[50,60],[50,70],[50,90],
      //   [60,10],[60,30],[60,40],[60,45],[60,50],[60,55],[60,60],[60,70],[60,90],
      //   [70,10],[70,50],[70,90],
      //   [90,10],[90,50],[90,90]],
      repetitions_per_point: 2,
      randomize_calibration_order: true,
    };

    var validation_instructions = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <p>Let's see how accurate the eye tracking is.</p>
        <p>Keep your head still, and move your eyes to focus on each dot as it appears.</p>
        <p>You do not need to click on the dots.</p>
        <p>Just move your eyes to look at the dots.</p>
      </div>
      `,
      choices: ["Click to begin"],
      post_trial_gap: 500,
    };

    var validation = {
      type: jsPsychWebgazerValidate,
      validation_points: [
        [50, 50],
        [25, 25],
        [25, 75],
        [75, 25],
        [75, 75],
      ],
      roi_radius: 100,
      time_to_saccade: 1000,
      validation_duration: 2000,
      show_validation_data: false,
      data: {
        task: "validate",
      },
    };

    var recalibrate_instructions = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <p>The accuracy of the calibration is a little lower than we'd like.</p>
        <p>Let's try calibrating one more time.</p>
        <p>Please repeat the calibration step on the next screen.<p>
      </div>

        `,
      choices: ["OK"],
    };

    var recalibrate = {
      timeline: [
        recalibrate_instructions,
        calibration,
        validation_instructions,
        validation,
      ],
      conditional_function: function () {
        var validation_data = jsPsych.data
          .get()
          .filter({ task: "validate" })
          .values()[0];
        var minimum_percent_acceptable = 60;
        var avg = 0;
        for (i = 0; i < validation_data.percent_in_roi.length; i++) {
          avg = avg + validation_data.percent_in_roi[i];
        }
        avg = avg / validation_data.percent_in_roi.length;
        jsPsych.extensions.webgazer.hidePredictions();
        return avg < minimum_percent_acceptable;
      },
      data: {
        phase: "recalibration",
      },
    };

    var quick_calibrate_instructions = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <p>We will do a quick calibration to ensure data quality.</p>
        <p>If you need to take a small pause, please do it now. <b>Remember your time-limit for the experiment.</b></p>
        <p>Just as before, click the dots when looking at them.</p>
        <p>Try to move your head as little as possible.</p>
        <p>The experiment will continue as normal after calibration.</p>
      </div>
      `,
      choices: ["Click to begin"],
      post_trial_gap: 50,
    };

    var quick_calibrate = {
      type: jsPsychWebgazerCalibrate,
      calibration_points: [
        [50, 50],
        [25, 25],
        [25, 75],
        [75, 25],
        [75, 75],
      ],
      repetitions_per_point: 1,
      randomize_calibration_order: true,
      on_start: function () {
        jsPsych.extensions.webgazer.hidePredictions();
      },
    };

    var quick_recalibrate = {
      timeline: [quick_calibrate_instructions, quick_calibrate],
      data: {
        phase: "quick_recalibration",
      },
    };

    /*
var recalibrate = {
  type: jsPsychHtmlButtonResponse,
  stimulus: `
    <p>Was the accuracy correct?</p>
  `,
  choices: ['Click to continue','Repeat Calibration'],
  post_trial_gap: 250,
  on_finish: function(data){
    // Score the response as correct or incorrect.
    console.log("Checking for calibration");
    console.log(data)
    if(jsPsych.pluginAPI.compareKeys(String(data.response), "1")){
      console.log("Should be recalibrated.");
      data.recalibrate = true;
    } else {
      console.log("Should be recalibrated.");
      data.recalibrate = false;
    }
  }
};

var if_recalibrate = {
    timeline: [calibration,validation,recalibrate],
    conditional_function: function(){
        // get the data from the previous trial,
        // and check which key was pressed
        var data = jsPsych.data.get().last(1).values()[0];
        return data.recalibrate;
    },
    post_trial_gap: 250,
}

*/
    var calibration_done = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
          <p>Great, we're done with calibration!</p>
        `,
      choices: ["OK"],
    };
    //#endregion

    //#region Task Instruction
    var task_instructions_hunting = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <h1>Task 2 (information searching task):</h1>
        <p>We're ready for the second task now.</p>
        <p>Each step is preceded by a black fixation cross in the middle of the screen, you should focus your gaze on it while it is being displayed. 
        <p>You'll be given one question to a short paragraph. You will first read the question.</p>
        <p>Take your time to <b>read the question and click continue when you are ready to read the paragraph.</b></p>
        <p>The paragraph will then be shown, and it contains the answer to the question you've seen.</p>
        <p>Take your time to <b>read the text and find the answer</b>. When <b>ready click the <i>Spacebar key</i> on your keyboard.</b></p>
        <p>You will see the question again. Now please answer the question based on what you read.
        <p>Remember, the answer <b>shouldn't be too long</b>, normally between <b>1 to 5 words.</b></p>
        <p>In total, you will perform <b>5 trials</b>.
        <p>Remember, there will be quick calibration steps after the 1st and 3rd trial, where you may also take a small break.
      </div>
      `,
      choices: ["Continue with Task 2"],
      post_trial_gap: 50,
    };

    var pre_hunting_trial = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
        <h3>Now you will perform the second task, information searching.</h3>
      `,
      choices: ["Continue to Task 2"],
      post_trial_gap: 50,
    };

    var task_instructions_normal = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
      <div class="left-align">
        <h1>Task 1 (normal reading task):</h1>
        <p>We're ready for the first task now.</p>
        <p>Each step is preceded by a black fixation cross in the middle of the screen, you should fixate it while it is being displayed. 
        <p>You'll be given a text to read in your own time. Once you finished reading, <b> click the <i>Spacebar key</i> on your keyboard.</b></p>
        <p>On the next screen, you will be given <b>one statement or question about the text.</b></p>
        <p>If given <b>a statement determine if it is True or False, by clicking on the corresponding button with your mouse.</b></p>
        <p>Otherwise, if it's <b>a question you will need enter your answer based on what you read in the paragraph on the previous screen.</b></p>
        <p>The answer <b>shouldn't be too long</b>, normally between <b>1 to 5 words.</b></p>
        <p>In total, you will perform <b>5 trials</b>.
        <p>Remember, there will be a quick calibration after the 2nd and 4th trial, where you may also take a small break.
      </div>
      `,
      choices: ["Continue with Task 1"],
      post_trial_gap: 50,
    };

    var pre_normal_trial = {
      type: jsPsychHtmlButtonResponse,
      stimulus: `
        <h3>Now you will perform the first task, normal reading.</h3>
      `,
      choices: ["Continue to Task 1"],
      post_trial_gap: 50,
    };

    //#endregion

    var fixation = {
      type: jsPsychHtmlKeyboardResponse,
      stimulus: '<p style="font-size:60px;">+</p>',
      choices: "NO_KEYS",
      trial_duration: 1500,
    };

    // Questions taken from StackOverflow
    // https://stackoverflow.com/questions/38909766/list-of-all-country-languages-for-dropdown-select-menu-html-form
    var questionaire = {
      type: jsPsychSurveyHtmlForm,
      preamble: `<b>Please fill out the following questionaire.</b>
    <p style="font-size: 13px; font-style: italic;">These questions will help evaluate the data.</p>
    `,
      html: `<p style="margin-bottom: 5px;">How old are you?
      <p style="margin-top: 5px; font-size: 13px;">(ex. 30)</p>
      <p><input name="age" type="text" required/>
      <p><style="margin-bottom: 5px;">What is your mother tongue?
      <p style="font-size: 13px; font-style: italic;">If your language isn't listed please let us know after you complete the experiment.</p>
      <p><select name="language" required>
            <option value="" disabled selected hidden>Choose a Language...</option>
            <option value="Afrikaans">Afrikaans</option>
            <option value="Albanian">Albanian</option>
            <option value="Arabic">Arabic</option>
            <option value="Armenian">Armenian</option>
            <option value="Basque">Basque</option>
            <option value="Bengali">Bengali</option>
            <option value="Bulgarian">Bulgarian</option>
            <option value="Catalan">Catalan</option>
            <option value="Cambodian">Cambodian</option>
            <option value="Chinese (Mandarin)">Chinese (Mandarin)</option>
            <option value="Croatian">Croatian</option>
            <option value="Czech">Czech</option>
            <option value="Danish">Danish</option>
            <option value="Dutch">Dutch</option>
            <option value="English">English</option>
            <option value="Estonian">Estonian</option>
            <option value="Fiji">Fiji</option>
            <option value="Finnish">Finnish</option>
            <option value="French">French</option>
            <option value="Georgian">Georgian</option>
            <option value="German">German</option>
            <option value="Greek">Greek</option>
            <option value="Gujarati">Gujarati</option>
            <option value="Hebrew">Hebrew</option>
            <option value="Hindi">Hindi</option>
            <option value="Hungarian">Hungarian</option>
            <option value="Icelandic">Icelandic</option>
            <option value="Indonesian">Indonesian</option>
            <option value="Irish">Irish</option>
            <option value="Italian">Italian</option>
            <option value="Japanese">Japanese</option>
            <option value="Javanese">Javanese</option>
            <option value="Korean">Korean</option>
            <option value="Latin">Latin</option>
            <option value="Latvian">Latvian</option>
            <option value="Lithuanian">Lithuanian</option>
            <option value="Macedonian">Macedonian</option>
            <option value="Malay">Malay</option>
            <option value="Malayalam">Malayalam</option>
            <option value="Maltese">Maltese</option>
            <option value="Maori">Maori</option>
            <option value="Marathi">Marathi</option>
            <option value="Mongolian">Mongolian</option>
            <option value="Nepali">Nepali</option>
            <option value="Norwegian">Norwegian</option>
            <option value="Persian">Persian</option>
            <option value="Polish">Polish</option>
            <option value="Portuguese">Portuguese</option>
            <option value="Punjabi">Punjabi</option>
            <option value="Quechua">Quechua</option>
            <option value="Romanian">Romanian</option>
            <option value="Russian">Russian</option>
            <option value="Samoan">Samoan</option>
            <option value="Serbian">Serbian</option>
            <option value="Slovak">Slovak</option>
            <option value="Slovenian">Slovenian</option>
            <option value="Spanish">Spanish</option>
            <option value="Swahili">Swahili</option>
            <option value="Swedish ">Swedish </option>
            <option value="Tamil">Tamil</option>
            <option value="Tatar">Tatar</option>
            <option value="Telugu">Telugu</option>
            <option value="Thai">Thai</option>
            <option value="Tibetan">Tibetan</option>
            <option value="Tonga">Tonga</option>
            <option value="Turkish">Turkish</option>
            <option value="Ukrainian">Ukrainian</option>
            <option value="Urdu">Urdu</option>
            <option value="Uzbek">Uzbek</option>
            <option value="Vietnamese">Vietnamese</option>
            <option value="Welsh">Welsh</option>
            <option value="Xhosa">Xhosa</option>
        </select>


      <p style="margin-bottom: 5px;">How fluent are you in Spanish?</p>
      <p style="margin-top: 5px; font-size: 13px;">(1 - Not Fluent, 5 - Native Fluency)</p>
      <p>
      1 <input type="radio" name="fluency" value="1" required> 
      2 <input type="radio" name="fluency" value="2" required> 
      3 <input type="radio" name="fluency" value="3" required>
      4 <input type="radio" name="fluency" value="4" required>
      5 <input type="radio" name="fluency" value="5" required> 
      <p>
`,

      data: {
        trial_name: "questionaire",
      },
      button_label: "Continue to Setup Instructions",
    };

    //#startregion Questions
    var meco_para_12 = {
      type: jsPsychImageKeyboardResponse,
      stimulus: "/static/images/mturk_ES_v05/meco_para_12_1280_720.png",
      data: {
        trial_name: "meco_para_12",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var meco_para_12_qa_1 = {
      type: jsPsychImageButtonResponse,
      stimulus: "/static/images/mturk_ES_v05/meco_para_12_qa_1_1280_720.png",
      prompt: `Paragraph 1: Please choose that fits the option based on the paragraph you read.`,
      data: {
        correct_answer: "False",
        trial_name: "meco_para_12_qa_1",
      },
      choices: ["True", "False"],
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-button-response-stimulus"] },
        },
      ],
    };
    var a_Kenya_1 = {
      type: jsPsychImageKeyboardResponse,
      stimulus: "/static/images/mturk_ES_v05/a_Kenya_1_1280_720.png",
      data: {
        trial_name: "a_Kenya_1",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var a_Kenya_1_qa_0 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 2: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/a_Kenya_1_qa_0_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "28 de febrero de 2008",
        trial_name: "a_Kenya_1_qa_0",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var a_Amazonrainforest_2 = {
      type: jsPsychImageKeyboardResponse,
      stimulus: "/static/images/mturk_ES_v05/a_Amazonrainforest_2_1280_720.png",
      data: {
        trial_name: "a_Amazonrainforest_2",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var a_Amazonrainforest_2_qa_1 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 3: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/a_Amazonrainforest_2_qa_1_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "aumento de asentamientos y de la deforestación",
        trial_name: "a_Amazonrainforest_2_qa_1",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var a_SouthernCalifornia_3 = {
      type: jsPsychImageKeyboardResponse,
      stimulus:
        "/static/images/mturk_ES_v05/a_SouthernCalifornia_3_1280_720.png",
      data: {
        trial_name: "a_SouthernCalifornia_3",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var a_SouthernCalifornia_3_qa_2 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 4: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/a_SouthernCalifornia_3_qa_2_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "la MLB",
        trial_name: "a_SouthernCalifornia_3_qa_2",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var a_Kenya_2 = {
      type: jsPsychImageKeyboardResponse,
      stimulus: "/static/images/mturk_ES_v05/a_Kenya_2_1280_720.png",
      data: {
        trial_name: "a_Kenya_2",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var a_Kenya_2_qa_3 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 5: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/a_Kenya_2_qa_3_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "julio de 2015",
        trial_name: "a_Kenya_2_qa_3",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var a_Force_4 = {
      type: jsPsychImageKeyboardResponse,
      stimulus: "/static/images/mturk_ES_v05/a_Force_4_1280_720.png",
      data: {
        trial_name: "a_Force_4",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var q_after_a_Force_4_qa_2 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 6: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/q_after_a_Force_4_qa_2_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "términos de presión",
        trial_name: "q_after_a_Force_4_qa_2",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var q_before_a_Force_4_qa_2 = {
      type: jsPsychImageButtonResponse,
      stimulus:
        "/static/images/mturk_ES_v05/q_after_a_Force_4_qa_2_1280_720.png",
      prompt: `Paragraph 6: Please read the question and continue - You don't have to answer.`,
      data: {
        trial_name: "q_before_a_Force_4_qa_2",
      },
      choices: ["Continue"],
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#jspsych-image-button-response-stimulus"],
          },
        },
      ],
    };
    var a_Computationalcomplexitytheory_0 = {
      type: jsPsychImageKeyboardResponse,
      stimulus:
        "/static/images/mturk_ES_v05/a_Computationalcomplexitytheory_0_1280_720.png",
      data: {
        trial_name: "a_Computationalcomplexitytheory_0",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var q_after_a_Computationalcomplexitytheory_0_qa_0 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 7: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_0_qa_0_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "La teoría de la complejidad computacional",
        trial_name: "q_after_a_Computationalcomplexitytheory_0_qa_0",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var q_before_a_Computationalcomplexitytheory_0_qa_0 = {
      type: jsPsychImageButtonResponse,
      stimulus:
        "/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_0_qa_0_1280_720.png",
      prompt: `Paragraph 7: Please read the question and continue - You don't have to answer.`,
      data: {
        trial_name: "q_before_a_Computationalcomplexitytheory_0_qa_0",
      },
      choices: ["Continue"],
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#jspsych-image-button-response-stimulus"],
          },
        },
      ],
    };
    var a_Construction_0 = {
      type: jsPsychImageKeyboardResponse,
      stimulus: "/static/images/mturk_ES_v05/a_Construction_0_1280_720.png",
      data: {
        trial_name: "a_Construction_0",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var q_after_a_Construction_0_qa_3 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 8: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/q_after_a_Construction_0_qa_3_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer:
          "planificación, el diseño [cita necesaria] y la financiación",
        trial_name: "q_after_a_Construction_0_qa_3",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var q_before_a_Construction_0_qa_3 = {
      type: jsPsychImageButtonResponse,
      stimulus:
        "/static/images/mturk_ES_v05/q_after_a_Construction_0_qa_3_1280_720.png",
      prompt: `Paragraph 8: Please read the question and continue - You don't have to answer.`,
      data: {
        trial_name: "q_before_a_Construction_0_qa_3",
      },
      choices: ["Continue"],
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#jspsych-image-button-response-stimulus"],
          },
        },
      ],
    };
    var a_Computationalcomplexitytheory_1 = {
      type: jsPsychImageKeyboardResponse,
      stimulus:
        "/static/images/mturk_ES_v05/a_Computationalcomplexitytheory_1_1280_720.png",
      data: {
        trial_name: "a_Computationalcomplexitytheory_1",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var q_after_a_Computationalcomplexitytheory_1_qa_4 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 9: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_1_qa_4_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "matrices de adyacencia",
        trial_name: "q_after_a_Computationalcomplexitytheory_1_qa_4",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var q_before_a_Computationalcomplexitytheory_1_qa_4 = {
      type: jsPsychImageButtonResponse,
      stimulus:
        "/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_1_qa_4_1280_720.png",
      prompt: `Paragraph 9: Please read the question and continue - You don't have to answer.`,
      data: {
        trial_name: "q_before_a_Computationalcomplexitytheory_1_qa_4",
      },
      choices: ["Continue"],
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#jspsych-image-button-response-stimulus"],
          },
        },
      ],
    };
    var a_Computationalcomplexitytheory_2 = {
      type: jsPsychImageKeyboardResponse,
      stimulus:
        "/static/images/mturk_ES_v05/a_Computationalcomplexitytheory_2_1280_720.png",
      data: {
        trial_name: "a_Computationalcomplexitytheory_2",
      },
      choices: " ",
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: { targets: ["#jspsych-image-keyboard-response-stimulus"] },
        },
      ],
    };
    var q_after_a_Computationalcomplexitytheory_2_qa_1 = {
      type: jsPsychSurveyText,
      preamble: `Paragraph 10: This time, write an answer based on the paragraph you read. If you don't know the answer, write 'idk'.<br>
                            <img src="/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_2_qa_1_1280_720.png" id="question"></img>`,
      questions: [
        {
          prompt: "",
          placeholder: "Your answer...",
          required: true,
        },
      ],
      data: {
        correct_answer: "conjunto de triples",
        trial_name: "q_after_a_Computationalcomplexitytheory_2_qa_1",
      },
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#question"],
          },
        },
      ],
    };
    var q_before_a_Computationalcomplexitytheory_2_qa_1 = {
      type: jsPsychImageButtonResponse,
      stimulus:
        "/static/images/mturk_ES_v05/q_after_a_Computationalcomplexitytheory_2_qa_1_1280_720.png",
      prompt: `Paragraph 10: Please read the question and continue - You don't have to answer.`,
      data: {
        trial_name: "q_before_a_Computationalcomplexitytheory_2_qa_1",
      },
      choices: ["Continue"],
      extensions: [
        {
          type: jsPsychExtensionWebgazer,
          params: {
            targets: ["#jspsych-image-button-response-stimulus"],
          },
        },
      ],
    };

    var timeline = [];
    timeline.push(preload);
    timeline.push(welcome);
    timeline.push(camera_instructions);
    timeline.push(subject_specs);
    timeline.push(trial_example_instructions);
    timeline.push(questionaire);
    timeline.push(instructions_light_screen_setup_image);
    timeline.push(before_camera);
    timeline.push(init_camera);
    timeline.push(enter_fullscreen);
    timeline.push(subject_specs);
    timeline.push(if_resolution_check);
    timeline.push(calibration_instructions);
    timeline.push(calibration);
    timeline.push(validation_instructions);
    timeline.push(validation);
    timeline.push(recalibrate);
    // Later test, to ensure that it picks up the right data.
    // Can also be used to compare versus the one after the fullscreen.
    timeline.push(subject_specs);

    // NORMAL READING ----
    timeline.push(task_instructions_normal);
    timeline.push(fixation);
    timeline.push(meco_para_12);
    timeline.push(fixation);
    timeline.push(meco_para_12_qa_1);
    timeline.push(fixation);
    timeline.push(a_Kenya_1);
    timeline.push(fixation);
    timeline.push(a_Kenya_1_qa_0);
    timeline.push(fixation);
    timeline.push(quick_recalibrate);
    timeline.push(fixation);
    timeline.push(a_Amazonrainforest_2);
    timeline.push(fixation);
    timeline.push(a_Amazonrainforest_2_qa_1);
    timeline.push(fixation);
    timeline.push(a_SouthernCalifornia_3);
    timeline.push(fixation);
    timeline.push(a_SouthernCalifornia_3_qa_2);
    timeline.push(fixation);
    timeline.push(quick_recalibrate);
    timeline.push(fixation);
    timeline.push(a_Kenya_2);
    timeline.push(fixation);
    timeline.push(a_Kenya_2_qa_3);
    timeline.push(fixation);

    // INFORMATION SEEKING READING ----
    timeline.push(task_instructions_hunting);
    timeline.push(fixation);
    timeline.push(q_before_a_Force_4_qa_2);
    timeline.push(fixation);
    timeline.push(a_Force_4);
    timeline.push(fixation);
    timeline.push(q_after_a_Force_4_qa_2);
    timeline.push(fixation);
    timeline.push(quick_recalibrate);
    timeline.push(fixation);
    timeline.push(q_before_a_Computationalcomplexitytheory_0_qa_0);
    timeline.push(fixation);
    timeline.push(a_Computationalcomplexitytheory_0);
    timeline.push(fixation);
    timeline.push(q_after_a_Computationalcomplexitytheory_0_qa_0);
    timeline.push(fixation);
    timeline.push(q_before_a_Construction_0_qa_3);
    timeline.push(fixation);
    timeline.push(a_Construction_0);
    timeline.push(fixation);
    timeline.push(q_after_a_Construction_0_qa_3);
    timeline.push(fixation);
    timeline.push(quick_recalibrate);
    timeline.push(fixation);
    timeline.push(q_before_a_Computationalcomplexitytheory_1_qa_4);
    timeline.push(fixation);
    timeline.push(a_Computationalcomplexitytheory_1);
    timeline.push(fixation);
    timeline.push(q_after_a_Computationalcomplexitytheory_1_qa_4);
    timeline.push(fixation);
    timeline.push(q_before_a_Computationalcomplexitytheory_2_qa_1);
    timeline.push(fixation);
    timeline.push(a_Computationalcomplexitytheory_2);
    timeline.push(fixation);
    timeline.push(q_after_a_Computationalcomplexitytheory_2_qa_1);
    timeline.push(fixation);

    timeline.push(experiment_done);
    timeline.push(exit_fullscreen);
    jsPsych.run(timeline);
  </script>
</html>
